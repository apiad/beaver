---
number: 4
title: "This is DONE Comprehensive async wrappers"
state: OPEN
labels:

---



## Tasks

- [ ] Dictionary wrapper
- [ ] List wrapper
- [ ] Queue wrapper
- [ ] Collections wrapper

### 1. Concept

A **Comprehensive Async API** will be introduced to allow seamless integration of `beaver-db` into modern `asyncio`-based applications. Instead of making the core library asynchronous, this feature will provide an elegant, on-demand way to get an async-compatible version of any core `beaver-db` object.

The core of the library will remain fully synchronous, respecting its design principle of a "Synchronous Core with Async Potential". The async functionality will be provided through thin, type-safe wrappers that run the blocking database calls in a background thread pool, ensuring the `asyncio` event loop is never blocked.

### 2. Use Cases

This feature is essential for developers using modern Python frameworks and for building highly concurrent applications:

 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock **Modern Web Backends**: Natively integrate `beaver-db` with frameworks like FastAPI or Starlette without needing to manage a separate thread pool executor for database calls.
 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock **High-Concurrency Tools**: Use `beaver-db` in applications that manage thousands of concurrent I/O operations (like websocket servers, scrapers, or chatbots) without sacrificing responsiveness.
 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock **Ergonomic Developer Experience**: Allow developers working in an `async` codebase to use the familiar `await` syntax for all database operations, leading to cleaner and more consistent code.

### 3. Proposed API

The API is designed to be flexible and explicit, allowing the developer to "opt-in" to the async version of an object whenever needed.

 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock `docs = db.collection("articles")`: The developer starts with the standard, synchronous object.
 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock `async_docs = docs.as_async()`: A new `.as_async()` method on any synchronous wrapper (`CollectionWrapper`, `ListWrapper`, etc.) will return a parallel `Async` version of that object.
 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock `await async_docs.index(my_doc)`: All methods on the `Async` wrapper are `async def` and must be awaited. The method names are identical to their synchronous counterparts, providing a clean and consistent API.
 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock `await docs.as_async().search(vector)`: For one-off calls, the developer can chain the methods for a concise, non-blocking operation.

### 4. Implementation Design: Type-Safe Parallel Wrappers

The implementation will prioritize correctness, flexibility, and compatibility with developer tooling.

1. **Parallel Class Hierarchy**: For each core wrapper (e.g., `CollectionWrapper`), there will be a corresponding `AsyncCollectionWrapper`. This new class will hold a reference to the original synchronous object.
2. **Explicit `async def` Methods**: Every method on the `Async` wrapper will be explicitly defined with `async def`. This ensures that type checkers (like Mypy) and IDEs can correctly identify them as awaitable, preventing common runtime errors and providing proper autocompletion.
3. **`asyncio.to_thread` Execution**: The implementation of each `async` method will simply call the corresponding synchronous method on the original object using `asyncio.to_thread`. This delegates the blocking I/O to a background thread, keeping the `asyncio` event loop free.

### 5. Alignment with Philosophy

This feature perfectly aligns with the library's guiding principles:

 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock **Synchronous Core with Async Potential**: It adds a powerful `async` layer without altering the simple, robust, and synchronous foundation of the library.
 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock **Simplicity and Pythonic API**: The `.as_async()` method is an intuitive and Pythonic way to opt into asynchronous behavior, and the chained-call syntax is elegant and clean.
 beaver design.md dist dockerfile examples issues LICENSE makefile pull-issues.sh pyproject.toml README.md roadmap.md uv.lock **Developer Experience**: By ensuring the `async` wrappers are explicitly typed, the design prioritizes compatibility with modern developer tools, preventing bugs and improving productivity.
